# ==============================================================================
# Pipeline Configuration - Single Source of Truth
# ==============================================================================
#
# This file controls the entire research pipeline. Edit values here and run:
#   ./run_research_pipeline.sh all
#
# All settings are read from this file. CLI arguments can override these values.
#
# ==============================================================================

# ------------------------------------------------------------------------------
# Paths - where data and outputs are stored
# ------------------------------------------------------------------------------
paths:
  data_dir: "plantvillage_ssl/data/plantvillage/balanced"
  output_dir: "output/research_pipeline"

# ------------------------------------------------------------------------------
# Python Environment
# ------------------------------------------------------------------------------
# Conda environment to use for PyTorch training and benchmarking
# Leave empty to use system Python or currently activated environment
#
python:
  conda_env: "pytorch_assignment_env"  # Conda environment name

# ------------------------------------------------------------------------------
# Dataset Configuration
# ------------------------------------------------------------------------------
# PlantVillage dataset split strategy:
#   - 30% Labeled Training (for initial supervised learning)
#   - 10% Validation (monitor training progress)
#   - 10% Test (final evaluation only)
#   - 50% SSL Stream Pool (all remaining images for semi-supervised learning)
#
dataset:
  num_classes: 39                    # PlantVillage has 39 disease classes
  image_size: 224                    # Input image size (square)
  labeled_ratio: 0.30                # 30% of data used as labeled training set
  validation_split: 0.10             # 10% for validation
  test_split: 0.10                   # 10% held out for final testing
  # Remaining 50% goes to SSL stream pool (calculated automatically)

# ------------------------------------------------------------------------------
# Training Settings
# ------------------------------------------------------------------------------
# These settings are shared by both Burn (Rust) and PyTorch training
#
training:
  epochs: 20                         # Number of training epochs
  batch_size: 32                     # Batch size for training
  learning_rate: 0.001               # Initial learning rate
  weight_decay: 0.0001               # L2 regularization
  dropout_rate: 0.3                  # Dropout rate for regularization

# ------------------------------------------------------------------------------
# Semi-Supervised Learning (SSL) Settings
# ------------------------------------------------------------------------------
# Controls the SSL simulation that uses pseudo-labeling on unlabeled data
#
ssl:
  enabled: true                      # Enable SSL simulation stage
  confidence_threshold: 0.90         # Min confidence to accept pseudo-label
  use_all_unlabeled: true            # Use ALL remaining images in stream pool
  retrain_threshold: 500             # Retrain model after N pseudo-labels
  retrain_epochs: 20                 # Epochs per retraining cycle

# ------------------------------------------------------------------------------
# Benchmarking Settings
# ------------------------------------------------------------------------------
# Controls inference and training benchmarks
#
benchmarking:
  enabled: true                      # Enable benchmarking stage
  iterations: 100                    # Number of inference iterations
  warmup: 10                         # Warmup iterations (excluded from timing)
  compare_frameworks: true           # Generate Burn vs PyTorch comparison charts

# ------------------------------------------------------------------------------
# Pipeline Stages
# ------------------------------------------------------------------------------
# Toggle individual stages on/off. Set to false to skip a stage.
#
stages:
  download_dataset: true             # Download PlantVillage dataset if not present
  train_burn: true                   # Train model using Burn (Rust)
  train_pytorch: false               # Train model using PyTorch
  ssl_simulation: true               # Run semi-supervised learning simulation
  benchmark: false                   # Run inference benchmarks
  compare: false                     # Generate comparison reports and charts
